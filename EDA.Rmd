---
title: "Your Document Title"
author: "Author Name"
date: "`r format(Sys.Date(), '%d %B, %Y')`"
output: 
  pdf_document:
    includes:
      in_header: header.tex
geometry: "margin=0.87in" # 2.5 cm approx 0.984 inches, use 0.87in for closer approximation
fontsize: 12pt
mainfont: Times New Roman
header-includes:
  - \usepackage{fancyhdr}
  - \pagestyle{fancy}
  - \fancyhf{}
  - \rhead{Group Member Names}
  - \cfoot{\thepage}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## R Markdown
```{r}
library(conflicted)
library(ggplot2)
library(GGally)
library(ggpubr)
library(tidyverse)
library(corrplot)
require(gridExtra)
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
```
# Introduction

We as human beings like to divide actions into moral and amoral. Some of these amoral actions, such as murder, theft and fraud, are codified in law and we call those transgressions crimes. It is in our best interest to avoid crime happening. Therefore, we try to punish those that commit them in hopes of it being a deterrent for future repetition. However, there might be other ways in which to minimise crime. In addition, we see that crime isn't happening uniformly everywhere. This leads us to the question: what makes a crime more likely to happen in a region?\
Clay[1857], concentrating on crime in England, analysed the following characteristics: Beer-(ale)-house numbers, worship attendance and public school attendance. The argument he provides for the latter two, is both allow for the public access to Christian moral values (although he criticises that the ability to read on its own is not enough). It is to note, the "public schools" mentioned by Clay concentrated mostly on teaching read and writing and were not free but accepted anyone who could effort it. In the case of beer-houses, he argues "the temptation to animal pleasure" corrupts a person. To help his case he tries to show the positive correlation of beer-houses, the negative correlations of public school and worship attendance to crime.\
In this paper we want to verify (or deny) these effects of the aforementioned characteristics and try to predict crime rate from them using the same data set. However, before starting it is important to mention, as noticed by Clay[1857], the recorded crime rate may be inaccurate because of systematic reasons since each county handles crime and punishment differently on the executive and juridical levels. This will impact the accuracy of all possible analysis and models.

# Exploratory Data Analysis 

We begin our analysis with a look at the first few lines of our dataset. 
```{r}
data <- read.csv('./data/beerhall.csv')
colnames(data)<- c("County", "RegionName", "RegionCode", "Criminals_100k", "BeerAle_100k","SchoolAttendance_10k", "WorshipAttendance_2k")

writeLines("\nFirst few data elements:\n")
str(data)
writeLines("\n")
# head(data)
# writeLines("\n")

```
```{r}
# returns minimum, maximum, 1st quartile, median, mean and 3rd
#quartile of every variable
writeLines("Data summary:\n")
summary(data)
writeLines("\n")

```
The dataset contains information about 40 different counties.`County` and `RegionName` are categorical variables, and each of the 8 regions is assigned a `RegionCode`, which is a number from 1 to 8. `Criminals_100k` is the number of criminals per 100,000 inhabitants for any particular county. Similarly, `BeerAle_100k`, `SchoolAttendance_10k` and `WorshipAttendance_2k` are social indicators measured numerically as a proportion of the population. In order to better visualise the numerical data, we plot histograms of each numerical variable, with the exception of the categorical `RegionCode`.
```{r}
# plot variable-wise histograms
numeric_data <- data[, sapply(data, is.numeric)]
data %>% pivot_longer(cols = c( Criminals_100k, BeerAle_100k,SchoolAttendance_10k, WorshipAttendance_2k)) %>%
  ggplot(aes(value)) + facet_wrap(~ name, scales = "free") + geom_histogram(bins = 15)

```
The `BeerAle_100k` variable appears to be bimodal. The histogram suggests that there are two common levels of alcohol consumption within the entire population, one around the 200, and another around 400 per 100,000 population. According to the data summary, `Crimanals_100k` has a mean of 152.9 and a median of 157.5, suggesting the symmetry that is also reflected in the histogram. `SchoolAttendance_10k` is slightly left skewed, while `WorshipAttendance_2k` has a varied but loosely symmetric distribution. 

The linear dependence between each pair of numeric variables is expressed in the following correlation matrix:
```{r}
# analyse correlation between variables
par(mfrow = c(1, 1))
M <- cor(numeric_data)
corrplot(cor(numeric_data), method = "number")
```

There appears to be negligible linear dependence between worship attendance and criminality. School attendance is slightly negatively correlated with the prevalence of crime. Criminal behaviour is positively correlated with `BeerAle_100k` with a correlation coefficient of 0.46, suggesting that counties with a more dominant culture of frequenting bars and pubs are also where more crime happens. In order to better visualise these dependencies, we regress `Criminals_100k` on each of these variables.

```{r}
# regression plots
fig1 <- ggplot(data, aes(BeerAle_100k, Criminals_100k)) + geom_point() +
  stat_smooth(method = "lm")
fig2 <- ggplot(data, aes(SchoolAttendance_10k, Criminals_100k)) + geom_point() +
  stat_smooth(method = "lm")
fig3 <- ggplot(data, aes(RegionCode, Criminals_100k)) + geom_point() +
  stat_smooth(method = "lm")
fig4 <- ggplot(data, aes(WorshipAttendance_2k, Criminals_100k)) + geom_point() +
  stat_smooth(method = "lm")

ggarrange(fig1, fig2, fig3, fig4)
```
There appears to be a very clear linear dependence of criminal behaviour on bar attendance, with most datapoints falling within the 95% confidence interval of the regression line. There is high variation of criminality across school attendance and worship attendance.
